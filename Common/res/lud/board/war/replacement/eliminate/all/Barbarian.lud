(define "HopSequence" ("HopCapture" (from #1) #2 (then ("ReplayIfCanMove" ("HopCapture" (from (last To)) SameDirection)))))

//------------------------------------------------------------------------------

(game "Barbarian" 
    (players 2) 
    (equipment { 
        (board (square 8))
        (piece "Marker" Each)
    }) 
    (rules 
        (start { 
            (place "Marker1" (difference (sites Phase 1) (sites Centre)))
            (place "Marker2" (difference (sites Phase 0) (sites Centre)))
        })
        (play 
            (if "SameTurn"
                (or
                    ("HopSequence" (last To) SameDirection)
                    (move Pass)
                )
                (priority {
                    (forEach Piece "Marker" ("HopSequence" (from) Orthogonal)) 
                    (forEach Piece "Marker" 
                        (move Step Diagonal 
                            (to if:(and 
                                (is In (to) (sites Empty)) 
                                (>=
                                    (count Sites
                                        in:(sites Around
                                            (to)
                                            Enemy
                                            Orthogonal
                                        )
                                    )
                                    1
                                )
                            ))
                        )
                    )
                    (forEach Piece "Marker" 
                        (move Step Diagonal 
                            (to if:(is In (to) (sites Empty)))
                        )
                    )
                })
            )
        )
        
        (end 
            (if (= (count Sites in:(sites Occupied by:Mover)) 0) (result Mover Loss))
        )
    )
)

//-------------------------------------------------------------------------

(metadata
    (info {
    	
    })
)